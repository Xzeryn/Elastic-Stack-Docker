# https://www.elastic.co/guide/en/logstash/current/plugins-inputs-kafka.html
input {
  kafka {
    bootstrap_servers => "kafka01:9092"
    topics => ["elk-docker"]
    auto_offset_reset => "earliest"
    auto_create_topics => "true"

   }
}

filter {
    grok {
    match => { "message" => "%{TIMESTAMP_ISO8601:timestamp} \{name=%{WORD:container_name}\} %{GREEDYDATA:csv_data}" }
  }
}

output {
  elasticsearch {
    index => "logstash-%{+YYYY.MM.dd}"
    hosts=> "${ELASTIC_HOSTS}"
    user=> "${ELASTIC_USER}"
    password=> "${ELASTIC_PASSWORD}"
    cacert=> "certs/ca/ca.crt"
  }
}